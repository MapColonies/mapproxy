[uwsgi]
master = true
chdir = /mapproxy
pyargv = /mapproxy/config/mapproxy.yaml
wsgi-file = /mapproxy/app.py
pidfile= /tmp/mapproxy.pid
socket = 0.0.0.0:8080
processes = $PROCESSES
threads = $THREADS
chmod-socket = 777
stats = :1717
stats-http = true
; uWSGI server logs
logger = uwsgilogger stdio
log-route = uwsgilogger ^((?!\{).)*$
log-encoder = json:uwsgilogger {"timestamp": "${strftime:%%Y-%%m-%%dT%%H:%%M:%%S}", "source": "uwsgi", "message": "${msg}"}
log-encoder = nl:uwsgilogger
; uWSGI request logs
logger-req = stdio
log-format = {"timestamp": "%(timestamp)", "source": "uwsgi", "type": "request", "status": %(status), "method": "%(method)", "path": "%(uri)", "user_agent": "%(uagent)", "duration_in_ms": %(msecs), "referer": "%(referer)", "host": "%(host)", "time": %(time), "remote_ip": "%(addr)""}